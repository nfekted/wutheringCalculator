<div class="container-fluid">
    <div class="row" style="background-color: rgb(148, 148, 148);">
        <div class="col-sm-6">
            <div class="row">
                <div class="col-sm-3 text-center">
                    <img class="img-fluid" [src]="'assets/img/characters/'+character.character.icon+'.png'"
                        style="width: 250px;border-radius: 0 0 50% 50%;" />
                    <h2 style="cursor: pointer;" *ngIf="!nameEdit" (click)="nameEdit = true">
                        <u>{{character.character.name}}</u>
                    </h2>
                    <input [(ngModel)]="character.character.name" *ngIf="nameEdit" (blur)="nameEdit = false;save()" />
                    <a [href]="character.character.wiki" target="_blank">WIKI</a><br />
                    <button class="btn btn-sm btn-danger mt-4" (click)="delete()">{{'deleteTab' | transloco}}</button>
                </div>
                <div class="col-sm-9">
                    <div class="row">
                        <div class="col-sm-12">
                            <div [innerHtml]="'char.characters.' + character.character.icon | transloco"></div>
                        </div>
                        <hr />
                        <div class="col-sm-1">
                            <img class="img-fluid" [src]="'assets/img/icons/'+character.character.type+'.webp'"
                                style="width: 100px;" />
                        </div>
                        <div class="col-sm-11">
                            <div [innerHtml]="'char.' + character.character.type | transloco"></div>
                        </div>
                        <div class="col-sm-1">
                            <img class="img-fluid" [src]="'assets/img/icons/'+character.character.weapon+'.webp'"
                                style="width: 100px;" />
                        </div>
                        <div class="col-sm-11">
                            <div [innerHtml]="'char.' + character.character.weapon | transloco"></div>
                        </div>
                        <hr />
                        <div class="col-sm-12 mt-1"><b>{{'char.attributes' | transloco}}</b></div>
                        <ng-container *ngIf="character.hpType">
                            <div class="col-sm-3">
                                <span style="float: right">HP:</span>
                            </div>
                            <div class="col-sm-3">
                                <input class="form-control" type="number" placeholder="100" min="0"
                                    [(ngModel)]="character.hp" (blur)="calculate()" />
                            </div>
                            <div class="col-sm-6"></div>
                        </ng-container>
                        <div class="col-sm-3 mt-2">
                            <span style="float: right">ATK:</span>
                        </div>
                        <div class="col-sm-3 mt-2">
                            <input class="form-control" type="number" placeholder="100" min="0"
                                [(ngModel)]="character.dmg" (blur)="calculate()" />
                        </div>
                        <ng-container *ngIf="character.defType">
                            <div class="col-sm-6"></div>
                            <div class="col-sm-3 mt-2">
                                <span style="float: right">DEF:</span>
                            </div>
                            <div class="col-sm-3 mt-2">
                                <input class="form-control" type="number" placeholder="0" min="0"
                                    [(ngModel)]="character.def" (blur)="calculate()" />
                            </div>
                        </ng-container>
                        <div class="col-sm-6"></div>
                        <div class="col-sm-3 mt-2">
                            <span style="float: right">Crit. Rate %:</span>
                        </div>
                        <div class="col-sm-3 mt-2">
                            <input class="form-control" type="number" placeholder="5%" min="0" max="100"
                                [(ngModel)]="character.cChance" />
                        </div>
                        <div class="col-sm-3 mt-2"></div>
                        <div class="col-sm-3"></div>
                        <div class="col-sm-3 mt-2">
                            <span style="float: right">Crit. DMG %:</span>
                        </div>
                        <div class="col-sm-3 mt-2">
                            <input class="form-control" type="number" placeholder="150%" min="0"
                                [(ngModel)]="character.cDmg" (blur)="calculate()" />
                        </div>
                        <div class="col-sm-6"></div>
                        <div class="col-sm-3 mt-2">
                            <span style="float: right">{{'char.skill' | transloco}} Bonus %:</span>
                        </div>
                        <div class="col-sm-3 mt-2">
                            <input class="form-control" type="number" placeholder="150%" min="0" max="100"
                                [(ngModel)]="character.skillBonus" (blur)="calculate()" />
                        </div>
                        <div class="col-sm-6"></div>
                        <div class="col-sm-3 mt-2">
                            <span style="float: right">{{'char.basic' | transloco}} Bonus %:</span>
                        </div>
                        <div class="col-sm-3 mt-2">
                            <input class="form-control" type="number" placeholder="150%" min="0" max="100"
                                [(ngModel)]="character.basicBonus" (blur)="calculate()" />
                        </div>
                        <div class="col-sm-6"></div>
                        <div class="col-sm-3 mt-2">
                            <span style="float: right">{{'char.heavy' | transloco}} Bonus %:</span>
                        </div>
                        <div class="col-sm-3 mt-2">
                            <input class="form-control" type="number" placeholder="150%" min="0" max="100"
                                [(ngModel)]="character.heavyBonus" (blur)="calculate()" />
                        </div>
                        <div class="col-sm-6"></div>
                        <div class="col-sm-3 mt-2">
                            <span style="float: right">Lib. Bonus %:</span>
                        </div>
                        <div class="col-sm-3 mt-2">
                            <input class="form-control" type="number" placeholder="150%" min="0" max="100"
                                [(ngModel)]="character.liberationBonus" (blur)="calculate()" />
                        </div>
                        <div class="col-sm-6"></div>
                        <div class="col-sm-3 mt-2">
                            <span style="float: right">{{'char.elemental' | transloco}} DMG %:</span>
                        </div>
                        <div class="col-sm-3 mt-2">
                            <input class="form-control" type="number" placeholder="150%" min="0" max="100"
                                [(ngModel)]="character.elementalBonus" (blur)="calculate()" />
                        </div>
                        <ng-container *ngIf="character.healType">
                            <div class="col-sm-6"></div>
                            <div class="col-sm-3 mt-2">
                                <span style="float: right">Healing Bonus %:</span>
                            </div>
                            <div class="col-sm-3 mt-2">
                                <input class="form-control" type="number" placeholder="150%" min="0" max="100"
                                    [(ngModel)]="character.healingBonus" (blur)="calculate()" />
                            </div>
                        </ng-container>

                        <div class="col-sm-6"></div>
                        <div class="col-sm-3 mt-2"></div>
                        <div class="col-sm-6 mt-2">
                            <button type="button" data-bs-toggle="modal"
                                [attr.data-bs-target]="'#critModal'+character.index" (click)="recalculateAll()"
                                [class]="'btn btn-primary btn-'+ currentSelection">
                                {{'char.enhancer.enhancer' | transloco}}
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row mt-5 mb-5">
                <div class="offset-1 col-sm-2 skill" (click)="upgrade(0)">
                    <div class="row skill-content text-center">
                        <div class="col-sm-12">
                            <img class="img-fluid" [src]="'assets/img/icons/'+character.character.weapon+'.webp'"
                                style="width: 50px;" />
                        </div>
                        <div class="col-sm-12">{{'char.basic' | transloco}}</div>
                        <div class="col-sm-12"><u>{{character.character.basicCurrent}}</u></div>
                    </div>
                </div>
                <div class="offset-1 col-sm-2 skill" (click)="upgrade(1)">
                    <div class="row skill-content text-center">
                        <div class="col-sm-12">
                            <img class="img-fluid" [src]="'assets/img/icons/'+character.character.icon+'-skill.webp'"
                                style="width: 50px;" />
                        </div>
                        <div class="col-sm-12">{{'char.skill' | transloco}}</div>
                        <div class="col-sm-12"><u>{{character.character.skillCurrent}}</u></div>
                    </div>
                </div>
                <div class="offset-1 col-sm-2 skill" (click)="upgrade(2)">
                    <div class="row skill-content text-center">
                        <div class="col-sm-12">
                            <img class="img-fluid" [src]="'assets/img/icons/'+character.character.icon+'-forte.webp'"
                                style="width: 50px;" />
                        </div>
                        <div class="col-sm-12">{{'char.forte' | transloco}}</div>
                        <div class="col-sm-12"><u>{{character.character.forteCurrent}}</u></div>
                    </div>
                </div>
                <div class="offset-1 col-sm-2 skill" (click)="upgrade(3)">
                    <div class="row skill-content text-center">
                        <div class="col-sm-12">
                            <img class="img-fluid"
                                [src]="'assets/img/icons/'+character.character.icon+'-liberation.webp'"
                                style="width: 50px;" />
                        </div>
                        <div class="col-sm-12">{{'char.liberation' | transloco}}</div>
                        <div class="col-sm-12"><u>{{character.character.liberationCurrent}}</u></div>
                    </div>
                </div>
                <div class="offset-1 col-sm-2 skill" (click)="upgrade(4)">
                    <div class="row skill-content text-center">
                        <div class="col-sm-12">
                            <img class="img-fluid" [src]="'assets/img/icons/'+character.character.icon+'-intro.webp'"
                                style="width: 50px;" />
                        </div>
                        <div class="col-sm-12">{{'char.intro' | transloco}}</div>
                        <div class="col-sm-12"><u>{{character.character.introCurrent}}</u></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6" style="border-left: solid 1px black;">
            <div class="row">
                <div class="col-sm-12 text-center">
                    <u>{{'char.prediction' | transloco}}</u>
                    <small>
                        <div [innerHtml]="'char.info' | transloco"></div>
                    </small>
                </div>
                <div class="col-sm-12 mb-3" *ngIf="showHelp">
                    <small>
                        <span>{{'char.description' | transloco}}:</span>
                        <div [innerHtml]="'char.help1' | transloco"></div>
                    </small>
                </div>
                <div class="col-sm-12 col-md-6">
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" role="switch" id="modeSwitch" [(ngModel)]="sum">
                        <label class="form-check-label" for="modeSwitch">{{'char.modes.' + (sum ? 'sum' : 'full')|
                            transloco}}</label>
                    </div>
                </div>
                <div class="col-sm-12 col-md-6">
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" role="switch" id="showHelp"
                            [(ngModel)]="showHelp">
                        <label class="form-check-label" for="showHelp">{{'char.showHelp' | transloco}}</label>
                    </div>
                </div>

                <div id="accordion">
                    <!-- Basic DMG -->
                    <div class="card text-bg-dark">
                        <div class="card-header" id="tableOne">
                            <h5 class="mb-0">
                                <span class="btn btn-dark" data-bs-toggle="collapse" href="#basic" aria-expanded="true"
                                    aria-controls="basic">
                                    <h4>{{'char.basic' | transloco}} DMG</h4>
                                </span>
                            </h5>
                        </div>

                        <div id="basic" class="collapse show" aria-labelledby="tableOne" data-parent="#accordion">
                            <div class="card-body">
                                <table class="table table-dark table-striped-columns text-center">
                                    <thead>
                                        <tr>
                                            <th scope="col">{{'char.type' | transloco}}</th>
                                            <th scope="col">{{'char.raw' | transloco}}</th>
                                            <th scope="col">{{'char.dmg' | transloco}}</th>
                                            <th scope="col">{{'char.dmgR' | transloco}}</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let b of character.character.basicNames; let i=index">
                                            <th scope="row">
                                                {{b}}
                                            </th>
                                            <!-- Detailed Mode -->
                                            <ng-container *ngIf="!sum">
                                                <td>
                                                    <!-- BASIC DAMAGE -->
                                                    <small *ngIf="character.character.basicMultiplier[i] > 1"
                                                        style="color: white;">{{character.character.basicMultiplier[i]}}x
                                                    </small>
                                                    {{character.basicDmg[i]}} (<b>{{(character.basicDmg[i] *
                                                        (character.cDmg/100)) |
                                                        number : '1.0-0'}}</b>)

                                                    <!-- SECOND BASIC DAMAGE -->
                                                    <ng-container *ngIf="character.basicSecondDmg[i] > 0">
                                                        <br />+<br />
                                                        <small *ngIf="character.character.basicSecondMultiplier[i] > 1"
                                                            style="color: white;">{{character.character.basicSecondMultiplier[i]}}x
                                                        </small>
                                                        {{character.basicSecondDmg[i]}}
                                                        (<b>{{(character.basicSecondDmg[i] *
                                                            (character.cDmg/100)) |
                                                            number : '1.0-0'}}</b>)
                                                    </ng-container>

                                                    <!-- THIRD BASIC DAMAGE -->
                                                    <ng-container *ngIf="character.basicThirdDmg[i] > 0">
                                                        <br />+<br />
                                                        <small *ngIf="character.character.basicSecondMultiplier[i] > 1"
                                                            style="color: white;">{{character.character.basicThirdMultiplier[i]}}x
                                                        </small>
                                                        {{character.basicThirdDmg[i]}} (<b>{{(character.basicThirdDmg[i]
                                                            * (character.cDmg/100)) | number : '1.0-0'}}</b>)
                                                    </ng-container>

                                                </td>
                                                <td>
                                                    <div [innerHtml]="character.basicCommonDmg[i]"></div>
                                                </td>
                                                <td>
                                                    <div [innerHtml]="character.basicResDmg[i]"></div>
                                                </td>
                                            </ng-container>
                                            <!-- End Detailed Mode -->
                                            <!-- Sum mode -->
                                            <ng-container *ngIf="sum">
                                                <td>
                                                    {{character.sumBasicDmg[i]}}
                                                    (<b>{{(character.sumBasicDmg[i] * (character.cDmg/100)) | number :
                                                        '1.0-0'}}</b>)
                                                </td>
                                                <td>
                                                    <div [innerHtml]="character.sumCommonDmg[i]"></div>
                                                </td>
                                                <td>
                                                    <div [innerHtml]="character.sumResDmg[i]"></div>
                                                </td>
                                            </ng-container>
                                            <!-- End Sum Mode -->
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <!-- End basic DMG-->
                    <hr />
                    <!-- Skills -->
                    <div class="card text-bg-dark">
                        <div class="card-header" id="tableTwo">
                            <h5 class="mb-0">
                                <span class="btn btn-dark" data-bs-toggle="collapse" href="#skills" aria-expanded="true"
                                    aria-controls="skills">
                                    <h4>{{'char.skill' | transloco}} DMG</h4>
                                </span>
                            </h5>
                        </div>

                        <div id="skills" class="collapse" aria-labelledby="tableTwo" data-parent="#accordion">
                            <div class="card-body">
                                <table class="table table-dark table-striped-columns text-center">
                                    <thead>
                                        <tr>
                                            <th scope="col">{{'char.type' | transloco}}</th>
                                            <th scope="col">{{'char.raw' | transloco}}</th>
                                            <th scope="col">{{'char.dmg' | transloco}}</th>
                                            <th scope="col">{{'char.dmgR' | transloco}}</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let b of character.character.skillNames; let i=index">
                                            <th scope="row">
                                                {{b}}
                                            </th>
                                            <!-- Detailed Mode -->
                                            <ng-container *ngIf="!sum">
                                                <td
                                                    [ngStyle]="{'color': character.character.skillHeal?.[i] ? 'lawngreen' : ''}">
                                                    <!-- Skill First Damage -->
                                                    <ng-container *ngIf="character.character.skillMultiplier[i] > 1">
                                                        <small
                                                            style="color: white;">{{character.character.skillMultiplier[i]}}x
                                                        </small>
                                                    </ng-container>
                                                    {{character.skillDmg[i]}}
                                                    <ng-container *ngIf="!character.character.skillHeal?.[i]">
                                                        (<b>{{(character.skillDmg[i] * (character.cDmg/100)) | number :
                                                            '1.0-0'}}</b>)
                                                    </ng-container>


                                                    <!-- Skill Second Damage -->
                                                    <ng-container *ngIf="character.skillSecondDmg[i] > 0">
                                                        <br />+<br />
                                                        <small *ngIf="character.character.skillSecondMultiplier[i] > 1"
                                                            style="color: white;">{{character.character.skillSecondMultiplier[i]}}x
                                                        </small>
                                                        {{character.skillSecondDmg[i]}}
                                                        <ng-container *ngIf="!character.character.skillHeal?.[i]">
                                                            (<b>{{(character.skillSecondDmg[i] * (character.cDmg/100)) |
                                                                number : '1.0-0'}}</b>)
                                                        </ng-container>
                                                    </ng-container>

                                                    <!-- Skill Third Damage -->
                                                    <ng-container *ngIf="character.skillThirdDmg[i] > 0">
                                                        <br />+<br />
                                                        <small *ngIf="character.character.skillThirdMultiplier[i] > 1"
                                                            style="color: white;">{{character.character.skillThirdMultiplier[i]}}x
                                                        </small>
                                                        {{character.skillThirdDmg[i]}} (<b>{{(character.skillThirdDmg[i]
                                                            * (character.cDmg/100)) | number : '1.0-0'}}</b>)
                                                    </ng-container>
                                                </td>
                                                <td>
                                                    <div [innerHtml]="character.skillCommonDmg[i]"
                                                        *ngIf="!character.character['skillHeal']?.[i]"></div>
                                                </td>
                                                <td>
                                                    <div [innerHtml]="character.skillResDmg[i]"
                                                        *ngIf="!character.character['skillHeal']?.[i]"></div>
                                                </td>
                                            </ng-container>
                                            <!-- Sum Mode -->
                                            <ng-container *ngIf="sum">
                                                <td
                                                    [ngStyle]="{'color': character.character.skillHeal?.[i] ? 'lawngreen' : ''}">
                                                    {{character.sumSkillDmg[i]}}
                                                    <ng-container *ngIf="!character.character.skillHeal?.[i]">
                                                        (<b>{{(character.sumSkillDmg[i] * (character.cDmg/100)) | number
                                                            : '1.0-0'}}</b>)
                                                    </ng-container>
                                                </td>
                                                <td>
                                                    <div [innerHtml]="character.sumCommonSkillDmg[i]"
                                                        *ngIf="!character.character.skillHeal?.[i]"></div>
                                                </td>
                                                <td>
                                                    <div [innerHtml]="character.sumResSkillDmg[i]"
                                                        *ngIf="!character.character.skillHeal?.[i]"></div>
                                                </td>
                                            </ng-container>
                                        </tr>
                                        <tr>
                                            <td colspan="5"><b>{{'char.liberation' | transloco}}</b></td>
                                        </tr>
                                        <tr *ngFor="let b of character.character.liberationNames; let i=index">
                                            <th scope="row">
                                                {{b}}
                                            </th>
                                            <!-- Detailed Mode -->
                                            <ng-container *ngIf="!sum">
                                                <td
                                                    [ngStyle]="{'color': character.character.liberationHeal?.[i] ? 'lawngreen' : ''}">
                                                    <!-- Liberation Damage -->
                                                    <ng-container
                                                        *ngIf="character.character.liberationMultiplier[i] > 1">
                                                        <small
                                                            style="color: white;">{{character.character.liberationMultiplier[i]}}x
                                                        </small>
                                                    </ng-container>
                                                    {{character.liberationDmg[i]}}
                                                    <ng-container *ngIf="!character.character.liberationHeal?.[i]">
                                                        (<b>{{(character.liberationDmg[i] * (character.cDmg/100)) |
                                                            number : '1.0-0'}}</b>)
                                                    </ng-container>

                                                    <!-- Liberation Second Damage -->
                                                    <ng-container *ngIf="character.liberationSecondDmg[i] > 0">
                                                        <br />+<br />
                                                        <small
                                                            *ngIf="character.character.liberationSecondMultiplier?.[i] > 1"
                                                            style="color: white;">{{character.character.liberationSecondMultiplier[i]}}x
                                                        </small>
                                                        {{character.liberationSecondDmg[i]}}
                                                        <ng-container *ngIf="!character.character.liberationHeal?.[i]">
                                                            (<b>{{(character.liberationSecondDmg[i] *
                                                                (character.cDmg/100)) | number : '1.0-0'}}</b>)
                                                        </ng-container>
                                                    </ng-container>

                                                    <!-- Liberation Third Damage -->
                                                    <!-- <ng-container *ngIf="character.liberationThirdDmg[i] > 0">
                                                        <br />+<br />
                                                        <small
                                                            *ngIf="character.character.liberationThirdMultiplier[i] > 1"
                                                            style="color: white;">{{character.character.liberationThirdMultiplier[i]}}x
                                                        </small>
                                                        {{character.liberationThirdDmg[i]}}
                                                        (<b>{{(character.liberationThirdDmg[i]
                                                            * (character.cDmg/100)) | number : '1.0-0'}}</b>)
                                                    </ng-container> -->
                                                </td>
                                                <td>
                                                    <div [innerHtml]="character.liberationCommonDmg[i]"
                                                        *ngIf="!character.character.liberationHeal?.[i]">
                                                    </div>
                                                </td>
                                                <td>
                                                    <div [innerHtml]="character.liberationResDmg[i]"
                                                        *ngIf="!character.character.liberationHeal?.[i]">
                                                    </div>
                                                </td>
                                            </ng-container>

                                            <!-- Sum mode -->
                                            <ng-container *ngIf="sum">
                                                <td
                                                    [ngStyle]="{'color': character.character.liberationHeal?.[i] ? 'lawngreen' : ''}">
                                                    {{character.sumLiberationDmg[i]}}
                                                    <ng-container *ngIf="!character.character.liberationHeal?.[i]">
                                                        (<b>{{(character.sumLiberationDmg[i] *
                                                            (character.cDmg/100)) | number : '1.0-0'}}</b>)
                                                    </ng-container>

                                                </td>
                                                <td>
                                                    <div [innerHtml]="character.sumCommonLibDmg[i]"
                                                        *ngIf="!character.character.liberationHeal?.[i]"></div>
                                                </td>
                                                <td>
                                                    <div [innerHtml]="character.sumResLibDmg[i]"
                                                        *ngIf="!character.character.liberationHeal?.[i]"></div>
                                                </td>
                                            </ng-container>

                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <!-- End Skill DMG-->
                    <hr />
                    <!-- Intro, Outro, Forte -->
                    <div class="card text-bg-dark">
                        <div class="card-header" id="tableThree">
                            <h5 class="mb-0">
                                <span class="btn btn-dark" data-bs-toggle="collapse" href="#intro" aria-expanded="true"
                                    aria-controls="intro">
                                    <h4>{{'char.intro' | transloco}}, {{'char.outro' | transloco}}, {{'char.forte' |
                                        transloco}} DMG</h4>
                                </span>
                            </h5>
                        </div>

                        <div id="intro" class="collapse" aria-labelledby="tableThree" data-parent="#accordion">
                            <div class="card-body">
                                <table class="table table-dark table-striped-columns text-center">
                                    <thead>
                                        <tr>
                                            <th scope="col">{{'char.type' | transloco}}</th>
                                            <th scope="col">{{'char.raw' | transloco}}</th>
                                            <th scope="col">{{'char.dmg' | transloco}}</th>
                                            <th scope="col">{{'char.dmgR' | transloco}}</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let b of character.character.introName; let i=index">
                                            <th scope="row">
                                                {{b}}
                                            </th>
                                            <!-- Detailed Intro -->
                                            <ng-container *ngIf="!sum">
                                                <td
                                                    [ngStyle]="{'color': character.character.introHeal?.[i] ? 'lawngreen' : ''}">
                                                    <ng-container *ngIf="character.character.introMultiplier[i] > 1">
                                                        <small
                                                            style="color: white;">{{character.character.introMultiplier[i]}}x
                                                        </small>
                                                    </ng-container>
                                                    {{character.introDmg[i]}}
                                                    <ng-container *ngIf="!character.character.introHeal?.[i]">
                                                        (<b>{{(character.introDmg[i] * (character.cDmg/100)) | number :
                                                            '1.0-0'}}</b>)
                                                    </ng-container>

                                                    <!-- Intro Second Damage -->
                                                    <ng-container *ngIf="character.introSecondDmg[i] > 0">
                                                        <br />+<br />
                                                        <small
                                                            *ngIf="character.character.introSecondMultiplier?.[i] > 1"
                                                            style="color: white;">{{character.character.introSecondMultiplier[i]}}x
                                                        </small>
                                                        {{character.introSecondDmg[i]}}
                                                        <ng-container *ngIf="!character.character.introHeal?.[i]">
                                                            (<b>{{(character.introSecondDmg[i] *
                                                                (character.cDmg/100)) | number : '1.0-0'}}</b>)
                                                        </ng-container>
                                                    </ng-container>
                                                </td>
                                                <td>
                                                    <div [innerHtml]="character.introCommonDmg[i]"
                                                        *ngIf="!character.character.introHeal?.[i]"></div>
                                                </td>
                                                <td>
                                                    <div [innerHtml]="character.introResDmg[i]"
                                                        *ngIf="!character.character.introHeal?.[i]"></div>
                                                </td>
                                            </ng-container>
                                            <!-- Sum Intro -->
                                            <ng-container *ngIf="sum">
                                                <td
                                                    [ngStyle]="{'color': character.character.introHeal?.[i] ? 'lawngreen' : ''}">
                                                    {{character.sumIntroDmg[i]}}
                                                    <ng-container *ngIf="!character.character.introHeal?.[i]">
                                                        (<b>{{(character.sumIntroDmg[i] *
                                                            (character.cDmg/100)) | number : '1.0-0'}}</b>)
                                                    </ng-container>

                                                </td>
                                                <td>
                                                    <div [innerHtml]="character.sumCommonIntroDmg[i]"
                                                        *ngIf="!character.character.introHeal?.[i]"></div>
                                                </td>
                                                <td>
                                                    <div [innerHtml]="character.sumResIntroDmg[i]"
                                                        *ngIf="!character.character.introHeal?.[i]"></div>
                                                </td>
                                            </ng-container>

                                        </tr>
                                        <!-- OUTRO -->
                                        <ng-container *ngIf="character.character.outroMultiplier[0] > 0">
                                            <tr>
                                                <td colspan="5">{{'char.outro' | transloco}}</td>
                                            </tr>
                                            <tr *ngFor="let b of character.character.outroName; let i=index">
                                                <th scope="row">
                                                    {{b}}
                                                </th>
                                                <!-- Detailed Outro -->
                                                <ng-container *ngIf="!sum">
                                                    <td
                                                        [ngStyle]="{'color': character.character.outroHeal?.[i] ? 'lawngreen' : ''}">
                                                        <ng-container
                                                            *ngIf="character.character.outroMultiplier[i] > 1">
                                                            <small
                                                                style="color: white;">{{character.character.outroMultiplier[i]}}x
                                                            </small>
                                                        </ng-container>
                                                        {{character.outroDmg[i]}}
                                                        <ng-container *ngIf="!character.character.outroHeal?.[i]">
                                                            (<b>{{(character.outroDmg[i] * (character.cDmg/100)) |
                                                                number : '1.0-0'}}</b>)
                                                        </ng-container>

                                                        <!-- Outro Second Damage -->
                                                        <ng-container *ngIf="character.outroSecondDmg[i] > 0">
                                                            <br />+<br />
                                                            <small
                                                                *ngIf="character.character.outroSecondMultiplier?.[i] > 1"
                                                                style="color: white;">{{character.character.outroSecondMultiplier[i]}}x
                                                            </small>
                                                            {{character.outroSecondDmg[i]}}
                                                            <ng-container *ngIf="!character.character.outroHeal?.[i]">
                                                                (<b>{{(character.outroSecondDmg[i] *
                                                                    (character.cDmg/100)) | number : '1.0-0'}}</b>)
                                                            </ng-container>
                                                        </ng-container>
                                                    </td>
                                                    <td>
                                                        <div [innerHtml]="character.outroCommonDmg[i]"
                                                            *ngIf="!character.character.outroHeal?.[i]"></div>
                                                    </td>
                                                    <td>
                                                        <div [innerHtml]="character.outroResDmg[i]"
                                                            *ngIf="!character.character.outroHeal?.[i]"></div>
                                                    </td>
                                                </ng-container>
                                                <!-- Sum Outro -->
                                                <ng-container *ngIf="sum">
                                                    <td
                                                        [ngStyle]="{'color': character.character.outroHeal?.[i] ? 'lawngreen' : ''}">
                                                        {{character.sumOutroDmg[i]}}
                                                        <ng-container *ngIf="!character.character.outroHeal?.[i]">
                                                            (<b>{{(character.sumOutroDmg[i] *
                                                                (character.cDmg/100)) | number : '1.0-0'}}</b>)
                                                        </ng-container>

                                                    </td>
                                                    <td>
                                                        <div [innerHtml]="character.sumCommonOutroDmg[i]"
                                                            *ngIf="!character.character.outroHeal?.[i]"></div>
                                                    </td>
                                                    <td>
                                                        <div [innerHtml]="character.sumResOutroDmg[i]"
                                                            *ngIf="!character.character.outroHeal?.[i]"></div>
                                                    </td>
                                                </ng-container>
                                            </tr>
                                        </ng-container>
                                        <!-- FORTE -->
                                        <tr>
                                            <td colspan="5">{{'char.forte' | transloco}}</td>
                                        </tr>
                                        <tr *ngFor="let b of character.character.forteName; let i=index">
                                            <th scope="row">
                                                {{b}}
                                            </th>
                                            <ng-container *ngIf="!sum">
                                                <td
                                                    [ngStyle]="{'color': character.character.forteHeal?.[i] ? 'lawngreen' : character.character.forteShield[i] ? 'yellow' : ''}">
                                                    <!-- Forte First Damage -->
                                                    <ng-container *ngIf="character.character.forteMultiplier[i] > 1">
                                                        <small
                                                            style="color: white;">{{character.character.forteMultiplier[i]}}x
                                                        </small>
                                                    </ng-container>
                                                    {{character.forteDmg[i]}}
                                                    <ng-container
                                                        *ngIf="!character.character.forteHeal?.[i] && !character.character.forteShield[i]">
                                                        (<b>{{(character.forteDmg[i] * (character.cDmg/100)) | number :
                                                            '1.0-0'}}</b>)
                                                    </ng-container>

                                                    <!-- Forte Second Damage -->
                                                    <ng-container *ngIf="character.forteSecondDmg[i] > 0">
                                                        <br />+<br />
                                                        <small *ngIf="character.character.forteSecondMultiplier[i] > 1"
                                                            style="color: white;">{{character.character.forteSecondMultiplier[i]}}x
                                                        </small>
                                                        {{character.forteSecondDmg[i]}}
                                                        <ng-container
                                                            *ngIf="!character.character.forteHeal?.[i] && !character.character.forteShield[i]">
                                                            (<b>{{(character.forteSecondDmg[i] * (character.cDmg/100)) |
                                                                number : '1.0-0'}}</b>)
                                                        </ng-container>
                                                    </ng-container>

                                                    <!-- forte Third Damage -->
                                                    <ng-container *ngIf="character.forteThirdDmg[i] > 0">
                                                        <br />+<br />
                                                        <small *ngIf="character.character.skillThirdMultiplier[i] > 1"
                                                            style="color: white;">{{character.character.forteThirdMultiplier[i]}}x
                                                        </small>
                                                        {{character.forteThirdDmg[i]}}
                                                        <ng-container
                                                            *ngIf="!character.character.forteHeal?.[i] && !character.character.forteShield[i]">
                                                            (<b>{{(character.forteThirdDmg[i]
                                                                * (character.cDmg/100)) | number : '1.0-0'}}</b>)
                                                        </ng-container>
                                                    </ng-container>
                                                </td>
                                                <td>
                                                    <div [innerHtml]="character.forteCommonDmg[i]"
                                                        *ngIf="!character.character.forteHeal?.[i] && !character.character.forteShield[i]">
                                                    </div>
                                                </td>
                                                <td>
                                                    <div [innerHtml]="character.forteResDmg[i]"
                                                        *ngIf="!character.character.forteHeal?.[i] && !character.character.forteShield[i]">
                                                    </div>
                                                </td>
                                            </ng-container>
                                            <ng-container *ngIf="sum">
                                                <td
                                                    [ngStyle]="{'color': character.character.forteHeal?.[i] ? 'lawngreen' : character.character.forteShield[i] ? 'yellow' : ''}">
                                                    {{character.sumForteDmg[i]}}
                                                    <ng-container
                                                        *ngIf="!character.character.forteHeal?.[i] && !character.character.forteShield[i]">
                                                        (<b>{{(character.sumForteDmg[i] * (character.cDmg/100)) | number
                                                            : '1.0-0'}}</b>)
                                                    </ng-container>
                                                </td>
                                                <td>
                                                    <div [innerHtml]="character.sumCommonForteDmg[i]"
                                                        *ngIf="!character.character.forteHeal?.[i] && !character.character.forteShield[i]">
                                                    </div>
                                                </td>
                                                <td>
                                                    <div [innerHtml]="character.sumResForteDmg[i]"
                                                        *ngIf="!character.character.forteHeal?.[i] && !character.character.forteShield[i]">
                                                    </div>
                                                </td>
                                            </ng-container>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <hr />
    </div>
</div>

<div class="modal fade modal-lg" [id]="'critModal'+character.index" tabindex="-1" aria-labelledby="critModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" style="margin-top: 10vh;">
        <div class="modal-content">
            <div [class]="'modal-header btn-'+ currentSelection">
                <h1 class="modal-title fs-5" id="critModalLabel">{{'char.enhancer.enhancer' | transloco}}</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <h4></h4>
                    <div class="col-sm-12">
                        <b>{{'options' | transloco}}</b>
                        <div class="row">
                            <div class="form-group col-sm-12 col-md-4">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" role="switch" id="enhancerBasic"
                                        [(ngModel)]="enhancerBasic"
                                        (change)="enhancerSkill = !enhancerBasic;recalculateAll()">
                                    <label class="form-check-label" for="enhancerBasic">{{'char.enhancer.enhancerBasic'
                                        |
                                        transloco}}</label>
                                </div>
                            </div>
                            <div class="form-group col-sm-12 col-md-4">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" role="switch" id="enhancerSkill"
                                        [(ngModel)]="enhancerSkill"
                                        (change)="enhancerBasic = !enhancerSkill;recalculateAll()">
                                    <label class="form-check-label" for="enhancerSkill">{{'char.enhancer.enhancerSkill'
                                        |
                                        transloco}}</label>
                                </div>
                            </div>
                            <div class="form-group col-sm-12 col-md-4">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" role="switch" id="enhancerRandom"
                                        [(ngModel)]="randomCrit" (change)="recalculateAll()">
                                    <label class="form-check-label" for="enhancerRandom">{{'char.enhancer.enhancerCrit'
                                        |
                                        transloco}}</label>
                                </div>
                            </div>
                        </div>
                        <div class="row" *ngIf="enhancerSkill">
                            <div class="col-sm-12">
                                <div [innerHtml]="'char.enhancer.rotationInfo' | transloco">
                                </div>
                            </div>
                            <div class="col-sm-12 mt-4">
                                <ol>
                                    <li *ngFor="let item of character.character.rotationName"><b>{{item}}</b></li>
                                </ol>
                            </div>
                        </div>
                        <hr />
                        <hr />
                    </div>
                    <div class="col-sm-12 col-md-4">
                        <small>
                            <div *ngIf="!randomCrit && !enhancerSkill"
                                [innerHtml]="'char.enhancer.fixedCritInfo' | transloco: { chance: character.cChance, qtd: qtdCrit, normal: 20-qtdCrit}">
                            </div>
                            <div *ngIf="enhancerSkill && !randomCrit && (!character.healType || character.atkType)"
                                [innerHtml]="'char.enhancer.rotationCritInfo' | transloco: {atkNum : character.character.rotation[0].length, chance: character.cChance, qtd: qtdCrit, normal:  character.character.rotation[0].length-qtdCrit}">
                            </div>
                            <div *ngIf="enhancerSkill && (character.healType && !character.atkType)">
                                {{'char.enhancer.healingInfo' | transloco}}
                            </div>
                            <div *ngIf="randomCrit" [innerHtml]="'char.enhancer.randomCritInfo' | transloco">
                            </div>

                        </small>
                    </div>
                    <div class="col-sm-12 col-md-4 text-center">

                    </div>
                    <div class="col-sm-12 col-md-4">
                        <small>
                            <div *ngIf="!randomCrit && !enhancerSkill"
                                [innerHtml]="'char.enhancer.fixedCritInfo' | transloco: { chance: newCritChance, qtd: newQtdCrit, normal: 20-newQtdCrit}">
                            </div>
                            <div *ngIf="enhancerSkill && !randomCrit && (!character.healType || character.atkType)"
                                [innerHtml]="'char.enhancer.rotationCritInfo' | transloco: {atkNum : character.character.rotation[0].length, chance: newCritChance, qtd: newQtdCrit, normal:  character.character.rotation[0].length-newQtdCrit}">
                            </div>
                            <div *ngIf="enhancerSkill && (character.healType && !character.atkType)">
                                {{'char.enhancer.healingInfo' | transloco}}
                            </div>
                            <div *ngIf="randomCrit" [innerHtml]="'char.enhancer.randomCritInfo' | transloco">
                            </div>
                        </small>
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-12 col-md-4">
                        <span class="badge text-bg-success"
                            *ngIf="fixedTotal > fixedSimTotal">{{'char.enhancer.bestScenario' |
                            transloco}} +{{fixedTotal - fixedSimTotal}}
                            {{(character.healType && enhancerSkill ? 'char.heal' : 'dmg') | transloco}}
                        </span>
                        <span class="badge text-bg-danger"
                            *ngIf="fixedTotal < fixedSimTotal">{{'char.enhancer.worstScenario' |
                            transloco}} -{{fixedSimTotal - fixedTotal}}
                            {{(character.healType && enhancerSkill ? 'char.heal' : 'dmg') | transloco}}
                        </span>
                        <table class="table table-striped"
                            [ngClass]="{'table-danger': fixedTotal < fixedSimTotal, 'table-success': fixedTotal > fixedSimTotal}">
                            <thead>
                                <tr class="text-center">
                                    <td colspan="3" scope="col"><b>{{'char.enhancer.current' | transloco}}</b></td>
                                </tr>
                                <tr class="text-center">
                                    <th scope="col">Atk n</th>
                                    <th scope="col">DMG</th>
                                    <th scope="col"></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let a of critSimFixed; let i=index" class="text-center">
                                    <th scope="row">{{i+1}}</th>
                                    <td>{{+a[0] | number:'1.0-0'}}</td>
                                    <td>
                                        <b *ngIf="!a[2]">{{a[1] ? 'CRIT' : ''}}</b>
                                        <b *ngIf="a[2]">{{'char.heal' | transloco}}</b>
                                    </td>
                                </tr>
                                <tr>
                                    <td><b>Total</b></td>
                                    <td colspan="2">~{{fixedTotal | number:'1.0-0'}}
                                        {{(character.healType && enhancerSkill ? 'char.heal' : 'dmg') | transloco}}
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="col-sm-12 col-md-4 text-center">
                        <div class="row">
                            <div class="col-sm-12">
                                <b>{{'char.enhancer.compareWith' | transloco}}</b>
                            </div>
                            <div class="col-sm-12 mt-3">
                                {{'new' | transloco}} ATK
                            </div>
                            <div class="col-sm-12">
                                <input class="form-control" type="number" placeholder="5%" min="0"
                                    [(ngModel)]="newAtk" />
                            </div>
                            <ng-container *ngIf="character.hpType">
                                <div class="col-sm-12 mt-3">
                                    {{'new' | transloco}} HP
                                </div>
                                <div class="col-sm-12">
                                    <input class="form-control" type="number" placeholder="0" min="0"
                                        [(ngModel)]="newHp" />
                                </div>
                            </ng-container>
                            <ng-container *ngIf="character.defType">
                                <div class="col-sm-12 mt-3">
                                    {{'new' | transloco}} DEF
                                </div>
                                <div class="col-sm-12">
                                    <input class="form-control" type="number" placeholder="0" min="0"
                                        [(ngModel)]="newDef" />
                                </div>
                            </ng-container>
                            <div class="col-sm-12 mt-3">
                                {{'new' | transloco}} Crit. Rate %
                            </div>
                            <div class="col-sm-12">
                                <input class="form-control" type="number" placeholder="5%" min="0"
                                    [(ngModel)]="newCritChance" />
                            </div>
                            <div class="col-sm-12">
                                {{'new' | transloco}} Crit. DMG %
                            </div>
                            <div class="col-sm-12">
                                <input class="form-control" type="number" placeholder="5%" min="0"
                                    [(ngModel)]="newCritDmg" />
                            </div>
                            <div class="col-sm-12">
                                {{'new' | transloco}} Skill Bonus %
                            </div>
                            <div class="col-sm-12">
                                <input class="form-control" type="number" placeholder="5%" min="0"
                                    [(ngModel)]="newSkillBonus" />
                            </div>
                            <div class="col-sm-12">
                                {{'new' | transloco}} Basic Bonus %
                            </div>
                            <div class="col-sm-12">
                                <input class="form-control" type="number" placeholder="5%" min="0"
                                    [(ngModel)]="newBasicBonus" />
                            </div>
                            <div class="col-sm-12">
                                {{'new' | transloco}} Heavy Bonus %
                            </div>
                            <div class="col-sm-12">
                                <input class="form-control" type="number" placeholder="5%" min="0"
                                    [(ngModel)]="newHeavyBonus" />
                            </div>
                            <div class="col-sm-12">
                                {{'new' | transloco}} Liberation Bonus %
                            </div>
                            <div class="col-sm-12">
                                <input class="form-control" type="number" placeholder="5%" min="0"
                                    [(ngModel)]="newLiberationBonus" />
                            </div>
                            <div class="col-sm-12">
                                {{'new' | transloco}} Elemental DMG %
                            </div>
                            <div class="col-sm-12">
                                <input class="form-control" type="number" placeholder="0%" min="0"
                                    [(ngModel)]="newElemental" />
                            </div>
                            <ng-container *ngIf="character.healType">
                                <div class="col-sm-12 mt-3">
                                    {{'new' | transloco}} Healing Bonus %
                                </div>
                                <div class="col-sm-12">
                                    <input class="form-control" type="number" placeholder="0" min="0"
                                        [(ngModel)]="newHealingBonus" />
                                </div>
                            </ng-container>
                            <div class="col-sm-12 mt-3">
                                <button type="button" (click)="recalculateAll()"
                                    [class]="'btn btn-secondary btn-'+ currentSelection">{{'char.enhancer.calculate'
                                    | transloco}}</button>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-12 col-md-4">
                        <span class="badge text-bg-success"
                            *ngIf="fixedTotal < fixedSimTotal">{{'char.enhancer.bestScenario' |
                            transloco}} +{{fixedSimTotal - fixedTotal}}
                            {{(character.healType && enhancerSkill ? 'char.heal' : 'dmg') | transloco}}
                        </span>
                        <span class="badge text-bg-danger"
                            *ngIf="fixedTotal > fixedSimTotal">{{'char.enhancer.worstScenario' |
                            transloco}} -{{fixedTotal - fixedSimTotal}}
                            {{(character.healType && enhancerSkill ? 'char.heal' : 'dmg') | transloco}}
                        </span>
                        <table class="table table-striped"
                            [ngClass]="{'table-danger': fixedTotal > fixedSimTotal, 'table-success': fixedTotal < fixedSimTotal}">
                            <thead>
                                <tr class="text-center">
                                    <td colspan="3" scope="col"><b>{{'char.enhancer.new' | transloco}}</b></td>
                                </tr>
                                <tr class="text-center">
                                    <th scope="col">Atk n</th>
                                    <th scope="col">DMG</th>
                                    <th scope="col"></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let a of critSimFixedSim; let i=index" class="text-center">
                                    <th scope="row">{{i+1}}</th>
                                    <td>{{+a[0] | number:'1.0-0'}}</td>
                                    <td>
                                        <b *ngIf="!a[2]">{{a[1] ? 'CRIT' : ''}}</b>
                                        <b *ngIf="a[2]">{{'char.heal' | transloco}}</b>
                                    </td>
                                </tr>
                                <tr>
                                    <td><b>Total</b></td>
                                    <td colspan="2">~{{fixedSimTotal | number:'1.0-0'}}
                                        {{(character.healType && enhancerSkill ? 'char.heal' : 'dmg') | transloco}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>
            <div class="modal-footer">
                <button type="button" data-bs-dismiss="modal"
                    [class]="'btn btn-secondary btn-'+ currentSelection">{{'close'
                    | transloco}}</button>
            </div>
        </div>
    </div>
</div>